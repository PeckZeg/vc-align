{"version":3,"sources":["../../../../../examples/VueTypes.vue","webpack:///./examples/VueTypes.vue?bf43","../../../../../examples/Point.vue","webpack:///./examples/Point.vue?4496","../../../../../src/util.ts","../../../../../src/Align.tsx","../../../../../src/hooks/useBuffer.ts","../../../../../examples sync nonrecursive //.vue$","../../../../../examples/Simple.vue","webpack:///./examples/Simple.vue?e129"],"names":["components","Align","data","state","props","methods","alignRef","node","this","$props","console","log","ref","JSON","stringify","style","marginBottom","point","onClick","pageX","pageY","target","align","points","monitorResize","element","callback","prevWidth","prevHeight","resizeObserver","ResizeObserver","document","contains","getBoundingClientRect","width","height","fixedWidth","Math","floor","fixedHeight","Promise","resolve","then","observe","disconnect","getElement","func","getPoint","defineComponent","name","VueTypes","shape","arrayOf","string","def","undefined","offset","number","targetOffset","overflow","adjustX","oneOfType","bool","adjustY","loose","useCssRight","useCssBottom","useCssTransform","returnUndefined","clientX","clientY","monitorBufferTime","monitorWindowResize","disabled","setup","ctx","onAlign","source","result","emit","cacheRef","nodeRef","forceAlignPropsRef","value","watch","toRef","buffer","calledRef","timeoutRef","cancelTrigger","window","clearTimeout","trigger","force","setTimeout","useBuffer","latestDisabled","latestTarget","activeElement","alignElement","alignPoint","container","focus","restoreFocus","forceAlign","cancelForceAlign","resizeMonitor","cancel","sourceResizeMonitor","onMounted","prev","next","watchEffect","winResizeRef","addEventListener","remove","onUnmounted","render","childNode","$slots","default","isVNode","cloneVNode","composeRef","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","module","exports","margin","monitor","random","randomWidth","sourceWidth","mounted","setInterval","beforeUnmount","clearInterval","getTarget","$container","getElementById","containerRef","ele","$align","toggleMonitor","toggleRandom","toggleDisabled","toggleSourceSize","type","checked","monitor-window-resize"],"mappings":"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","file":"static/js/main.e1e4c58c.chunk.js","sourcesContent":["<template>\n  <Align :ref=\"alignRef\">\n    <span />\n  </Align>\n\n  <pre>{{\n    JSON.stringify(\n      state.props,\n      (k, v) => (v === undefined ? '~undefined~' : v),\n      2\n    )\n  }}</pre>\n</template>\n\n<script>\nimport Align from '../src';\n\nexport default {\n  components: { Align },\n\n  data() {\n    return {\n      state: { props: null }\n    };\n  },\n\n  methods: {\n    alignRef(node) {\n      this.state.props = node ? { ...node.$props } : null;\n\n      // eslint-disable-next-line no-console\n      console.log(node);\n    }\n  }\n};\n</script>\n","import { render } from \"./VueTypes.vue?vue&type=template&id=8f292482&bindings={\\\"state\\\":\\\"data\\\",\\\"alignRef\\\":\\\"options\\\"}\"\nimport script from \"./VueTypes.vue?vue&type=script&lang=js\"\nexport * from \"./VueTypes.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div :style=\"{ marginBottom: '170px' }\">\n    <div\n      :style=\"{\n        margin: '20px',\n        border: '1px solid red',\n        padding: '100px 0',\n        textAlign: 'center'\n      }\"\n      @click=\"onClick\"\n    >\n      Click this region please : )\n    </div>\n\n    <Align :target=\"state.point\" :align=\"{ points: ['cc', 'cc'] }\">\n      <div\n        :style=\"{\n          position: 'absolute',\n          width: '100px',\n          height: '100px',\n          background: 'rgba(0, 255, 0, 0.5)',\n          pointerEvents: 'none'\n        }\"\n      >\n        Align\n      </div>\n    </Align>\n  </div>\n</template>\n\n<script>\nimport Align from '../src';\n\nexport default {\n  components: { Align },\n\n  data() {\n    return {\n      state: {\n        point: null\n      }\n    };\n  },\n\n  methods: {\n    onClick({ pageX, pageY }) {\n      this.state.point = { pageX, pageY };\n    }\n  }\n};\n</script>\n","import { render } from \"./Point.vue?vue&type=template&id=42cf3638&bindings={\\\"state\\\":\\\"data\\\",\\\"onClick\\\":\\\"options\\\"}\"\nimport script from \"./Point.vue?vue&type=script&lang=js\"\nexport * from \"./Point.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import ResizeObserver from 'resize-observer-polyfill';\nimport { TargetPoint } from './interface';\n\nimport contains from '@ayase/vc-util/lib/Dom/contains';\n\nexport function isSamePoint(prev: TargetPoint, next: TargetPoint) {\n  if (prev === next) return true;\n  if (!prev || !next) return false;\n\n  if ('pageX' in next && 'pageY' in next) {\n    return prev.pageX === next.pageX && prev.pageY === next.pageY;\n  }\n\n  if ('clientX' in next && 'clientY' in next) {\n    return prev.clientX === next.clientX && prev.clientY === next.clientY;\n  }\n\n  return false;\n}\n\nexport function restoreFocus(activeElement, container) {\n  // Focus back if is in the container\n  if (\n    activeElement !== document.activeElement &&\n    contains(container, activeElement) &&\n    typeof activeElement.focus === 'function'\n  ) {\n    activeElement.focus();\n  }\n}\n\nexport function monitorResize(element: HTMLElement, callback: Function) {\n  let prevWidth: number = null;\n  let prevHeight: number = null;\n\n  function onResize([{ target }]: ResizeObserverEntry[]) {\n    if (!document.contains(target)) return;\n    const { width, height } = target.getBoundingClientRect();\n    const fixedWidth = Math.floor(width);\n    const fixedHeight = Math.floor(height);\n\n    if (prevWidth !== fixedWidth || prevHeight !== fixedHeight) {\n      // https://webkit.org/blog/9997/resizeobserver-in-webkit/\n      Promise.resolve().then(() => {\n        callback({ width: fixedWidth, height: fixedHeight });\n      });\n    }\n\n    prevWidth = fixedWidth;\n    prevHeight = fixedHeight;\n  }\n\n  const resizeObserver = new ResizeObserver(onResize);\n  if (element) {\n    resizeObserver.observe(element);\n  }\n\n  return () => {\n    resizeObserver.disconnect();\n  };\n}\n","import addEventListener from '@ayase/vc-util/lib/Dom/addEventListener';\nimport { alignElement, alignPoint } from 'dom-align';\nimport { AlignResult, AlignType, TargetPoint, TargetType } from './interface';\nimport VueTypes from 'vue-types';\nimport { Ref } from 'vue';\n\nimport {\n  defineComponent,\n  cloneVNode,\n  isVNode,\n  onMounted,\n  onUnmounted,\n  watchEffect,\n  watch,\n  toRef,\n  ref\n} from 'vue';\nimport { composeRef } from '@ayase/vc-util/lib/ref';\nimport { returnUndefined } from '@ayase/vc-util';\nimport useBuffer from './hooks/useBuffer';\nimport { isSamePoint, monitorResize, restoreFocus } from './util';\n\ntype OnAlign = (source: HTMLElement, result: AlignResult) => void;\n\nexport interface AlignProps {\n  align: AlignType;\n  target: TargetType;\n  monitorBufferTime?: number;\n  monitorWindowResize?: boolean;\n  disabled?: boolean;\n  // children: React.ReactElement;\n}\n\nexport interface AlignRawBindings extends RefAlign {\n  nodeRef: Ref<any>;\n}\n\nexport interface AlignEmits {\n  onAlign?: OnAlign;\n}\n\ninterface MonitorRef {\n  element?: HTMLElement;\n  cancel: () => void;\n}\n\nexport interface RefAlign {\n  forceAlign: () => void;\n}\n\nfunction getElement(func: TargetType) {\n  if (typeof func !== 'function') {\n    return null;\n  }\n\n  return func();\n}\n\nfunction getPoint(point: TargetType) {\n  if (typeof point !== 'object' || !point) {\n    return null;\n  }\n\n  return point;\n}\n\nexport default defineComponent<AlignProps, AlignRawBindings>({\n  name: 'Align',\n\n  props: {\n    align: VueTypes.shape({\n      points: VueTypes.arrayOf(VueTypes.string).def(undefined),\n      offset: VueTypes.arrayOf(VueTypes.number).def(undefined),\n      targetOffset: VueTypes.arrayOf(VueTypes.number).def(undefined),\n      overflow: VueTypes.shape({\n        adjustX: VueTypes.oneOfType([VueTypes.bool, VueTypes.number]),\n        adjustY: VueTypes.oneOfType([VueTypes.bool, VueTypes.number])\n      }).loose,\n\n      useCssRight: VueTypes.bool.def(undefined),\n      useCssBottom: VueTypes.bool.def(undefined),\n      useCssTransform: VueTypes.bool.def(undefined)\n    }).loose.def(returnUndefined),\n\n    target: VueTypes.oneOfType([\n      VueTypes.func,\n      VueTypes.shape({\n        clientX: VueTypes.number,\n        clientY: VueTypes.number,\n        pageX: VueTypes.number,\n        pageY: VueTypes.number\n      }).loose\n    ]).def(returnUndefined),\n\n    monitorBufferTime: VueTypes.number.def(returnUndefined as undefined),\n    monitorWindowResize: VueTypes.bool.def(undefined),\n    disabled: VueTypes.bool.def(undefined)\n  } as undefined,\n\n  setup(props, ctx) {\n    const onAlign = (source, result) => ctx.emit('align', source, result);\n\n    const cacheRef = ref<{ element?: HTMLElement; point?: TargetPoint }>({});\n    const nodeRef = ref();\n\n    // ===================== Align ======================\n    // We save the props here to avoid closure makes props ood\n    const forceAlignPropsRef = ref<{\n      disabled?: boolean;\n      target?: TargetType;\n      onAlign?: OnAlign;\n    }>({});\n\n    forceAlignPropsRef.value.disabled = props.disabled;\n    forceAlignPropsRef.value.target = props.target;\n    forceAlignPropsRef.value.onAlign = onAlign;\n\n    watch(\n      [toRef(props, 'disabled'), toRef(props, 'target')] as const,\n      ([disabled, target]) => {\n        forceAlignPropsRef.value.disabled = disabled;\n        forceAlignPropsRef.value.target = target;\n      }\n    );\n\n    const [forceAlign, cancelForceAlign] = useBuffer(() => {\n      const {\n        disabled: latestDisabled,\n        target: latestTarget\n      } = forceAlignPropsRef.value;\n\n      if (!latestDisabled && latestTarget) {\n        const source = nodeRef.value;\n        const element = getElement(latestTarget);\n        const point = getPoint(latestTarget);\n        let result: AlignResult;\n\n        cacheRef.value.element = element;\n        cacheRef.value.point = point;\n\n        // IE lose focus after element realign\n        // We should record activeElement and restore later\n        const { activeElement } = document;\n\n        if (element) {\n          result = alignElement(source, element, props.align);\n        } else if (point) {\n          result = alignPoint(source, point, props.align);\n        }\n\n        restoreFocus(activeElement, source);\n        onAlign(source, result);\n\n        return true;\n      }\n\n      return false;\n    }, props.monitorBufferTime);\n\n    // ===================== Effect =====================\n    // Listen for target updated\n    const resizeMonitor = ref<MonitorRef>({ cancel: () => {} });\n\n    // Listen for source updated\n    const sourceResizeMonitor = ref<MonitorRef>({ cancel: () => {} });\n\n    onMounted(() => {\n      const element = getElement(props.target);\n      const point = getPoint(props.target);\n\n      if (nodeRef.value !== sourceResizeMonitor.value.element) {\n        sourceResizeMonitor.value.cancel();\n        sourceResizeMonitor.value.element = nodeRef.value;\n        sourceResizeMonitor.value.cancel = monitorResize(\n          nodeRef.value,\n          forceAlign\n        );\n      }\n\n      if (\n        cacheRef.value.element !== element ||\n        !isSamePoint(cacheRef.value.point, point)\n      ) {\n        forceAlign();\n\n        // Add resize observer\n        if (resizeMonitor.value.element !== element) {\n          resizeMonitor.value.cancel();\n          resizeMonitor.value.element = element;\n          resizeMonitor.value.cancel = monitorResize(element, forceAlign);\n        }\n      }\n    });\n\n    // Listen for disabled change\n    watchEffect(() => {\n      if (!props.disabled) {\n        forceAlign();\n      } else {\n        cancelForceAlign();\n      }\n    });\n\n    // Listen for window resize\n    const winResizeRef = ref<{ remove: Function }>(null);\n\n    watchEffect(() => {\n      if (props.monitorWindowResize) {\n        if (!winResizeRef.value) {\n          winResizeRef.value = addEventListener(window, 'resize', forceAlign);\n        }\n      } else if (winResizeRef.value) {\n        winResizeRef.value.remove();\n        winResizeRef.value = null;\n      }\n    });\n\n    // Clear all if unmount\n    onUnmounted(() => {\n      resizeMonitor.value.cancel();\n      sourceResizeMonitor.value.cancel();\n\n      if (winResizeRef.value) {\n        winResizeRef.value.remove();\n      }\n\n      cancelForceAlign();\n    });\n\n    return {\n      forceAlign: () => forceAlign(true),\n      nodeRef\n    };\n  },\n\n  render() {\n    let childNode = this.$slots.default()[0];\n\n    if (isVNode(childNode)) {\n      childNode = cloneVNode(childNode, {\n        ref: composeRef(childNode.ref, 'nodeRef')\n      });\n    }\n\n    return childNode;\n  }\n});\n","import { ref } from 'vue';\n\nexport default (callback: () => boolean, buffer: number) => {\n  const calledRef = ref<boolean>(false);\n  const timeoutRef = ref<number>(null);\n\n  function cancelTrigger() {\n    window.clearTimeout(timeoutRef.value);\n  }\n\n  function trigger(force?: boolean) {\n    if (!calledRef.value || force === true) {\n      if (callback() === false) {\n        // Not delay since callback cancelled self\n        return;\n      }\n\n      calledRef.value = true;\n      cancelTrigger();\n\n      timeoutRef.value = window.setTimeout(() => {\n        calledRef.value = false;\n      }, buffer);\n    } else {\n      cancelTrigger();\n      timeoutRef.value = window.setTimeout(() => {\n        calledRef.value = false;\n        trigger();\n      }, buffer);\n    }\n  }\n\n  return [\n    trigger,\n    () => {\n      calledRef.value = false;\n      cancelTrigger();\n    }\n  ] as const;\n};\n","var map = {\n\t\"./Point.vue\": 101,\n\t\"./Simple.vue\": 99,\n\t\"./VueTypes.vue\": 100\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 56;","<template>\n  <div :style=\"{ margin: '50px' }\">\n    <p>\n      <button type=\"button\" @click=\"forceAlign\">Force align</button>\n      &nbsp;&nbsp;&nbsp;\n      <button type=\"button\" @click=\"toggleSourceSize\">Resize Source</button>\n      &nbsp;&nbsp;&nbsp;\n      <label>\n        <input\n          type=\"checkbox\"\n          :checked=\"state.monitor\"\n          @change=\"toggleMonitor\"\n        />\n        Monitor window resize\n      </label>\n      <label>\n        <input type=\"checkbox\" :checked=\"state.random\" @change=\"toggleRandom\" />\n        Random Size\n      </label>\n      <label>\n        <input\n          type=\"checkbox\"\n          :checked=\"state.disabled\"\n          @change=\"toggleDisabled\"\n        />\n        Disabled\n      </label>\n    </p>\n\n    <div\n      id=\"container\"\n      :ref=\"containerRef\"\n      :style=\"{\n        border: '1px solid red',\n        width: '80%',\n        height: '500px',\n        ...(state.random ? { width: `${state.randomWidth}%` } : null)\n      }\"\n    >\n      <Align\n        :ref=\"alignRef\"\n        :target=\"getTarget\"\n        :monitor-window-resize=\"state.monitor\"\n        :align=\"state.align\"\n        :disabled=\"state.disabled\"\n      >\n        <div\n          :style=\"{\n            position: 'absolute',\n            width: `${state.sourceWidth}px`,\n            height: '50px',\n            background: 'yellow'\n          }\"\n        >\n          <input :style=\"{ width: '100%' }\" />\n        </div>\n      </Align>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Align from '../src';\n\nexport default {\n  components: { Align },\n\n  data() {\n    return {\n      state: {\n        monitor: true,\n        random: false,\n        disabled: false,\n        randomWidth: 100,\n        align: {\n          points: ['cc', 'cc']\n        },\n        sourceWidth: 50\n      }\n    };\n  },\n\n  watch: {\n    ['state.disabled'](disabled) {\n      // eslint-disable-next-line no-console\n      console.log({ disabled });\n    }\n  },\n\n  mounted() {\n    this.id = setInterval(() => {\n      const { random } = this.state;\n\n      if (random) {\n        this.state.randomWidth = 60 + 40 * Math.random();\n      }\n    }, 1000);\n  },\n\n  beforeUnmount() {\n    clearInterval(this.id);\n  },\n\n  methods: {\n    getTarget() {\n      if (!this.$container) {\n        // parent ref not attached\n        this.$container = document.getElementById('container');\n      }\n\n      return this.$container;\n    },\n\n    containerRef(ele) {\n      this.$container = ele;\n    },\n\n    alignRef(node) {\n      this.$align = node;\n    },\n\n    toggleMonitor() {\n      this.state.monitor = !this.state.monitor;\n    },\n\n    toggleRandom() {\n      this.state.random = !this.state.random;\n    },\n\n    toggleDisabled() {\n      this.state.disabled = !this.state.disabled;\n    },\n\n    forceAlign() {\n      this.$align.forceAlign();\n    },\n\n    toggleSourceSize() {\n      this.state.sourceWidth = this.state.sourceWidth + 10;\n    }\n  }\n};\n</script>\n","import { render } from \"./Simple.vue?vue&type=template&id=78ea3948&bindings={\\\"state\\\":\\\"data\\\",\\\"getTarget\\\":\\\"options\\\",\\\"containerRef\\\":\\\"options\\\",\\\"alignRef\\\":\\\"options\\\",\\\"toggleMonitor\\\":\\\"options\\\",\\\"toggleRandom\\\":\\\"options\\\",\\\"toggleDisabled\\\":\\\"options\\\",\\\"forceAlign\\\":\\\"options\\\",\\\"toggleSourceSize\\\":\\\"options\\\"}\"\nimport script from \"./Simple.vue?vue&type=script&lang=js\"\nexport * from \"./Simple.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}